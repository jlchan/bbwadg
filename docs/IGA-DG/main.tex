\pdfoutput=1

%\documentclass[preprint,10pt]{elsarticle}
%\documentclass[10pt]{article}
%\documentclass[review]{siamart0216}
\documentclass{siamart0216}

\usepackage{fullpage}
\usepackage{amsmath,amssymb,amsfonts}
\usepackage[titletoc,toc,title]{appendix}

\usepackage{array} 
\usepackage{listings}
\usepackage{mathtools}
\usepackage{pdfpages}
\usepackage[textsize=footnotesize,color=green]{todonotes}
\usepackage{bm}
%\usepackage{tikz}
\usepackage[normalem]{ulem}
\usepackage{hhline}

%% ====================================== alg package
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{algorithmicx}
\algblock{ParFor}{EndParFor}
% customising the new block
\algnewcommand\algorithmicparfor{\textbf{parfor}}
\algnewcommand\algorithmicpardo{\textbf{do}}
\algnewcommand\algorithmicendparfor{\textbf{end\ parfor}}
\algrenewtext{ParFor}[1]{\algorithmicparfor\ #1\ \algorithmicpardo}
\algrenewtext{EndParFor}{\algorithmicendparfor}
%% ====================================== end alg package

\usepackage{graphicx}
\usepackage{subfig}
\usepackage{color}

%% ====================================== graphics

\usepackage{pgfplots}
\usepackage{pgfplotstable}
\definecolor{markercolor}{RGB}{124.9, 255, 160.65}
\pgfplotsset{width=10cm,compat=1.3}
\pgfplotsset{
tick label style={font=\small},
label style={font=\small},
legend style={font=\small}
}

\usetikzlibrary{calc}

%%% START MACRO FOR ANNOTATION OF TRIANGLE WITH SLOPE %%%.
\newcommand{\logLogSlopeTriangle}[5]
{
    % #1. Relative offset in x direction.
    % #2. Width in x direction, so xA-xB.
    % #3. Relative offset in y direction.
    % #4. Slope d(y)/d(log10(x)).
    % #5. Plot options.

    \pgfplotsextra
    {
        \pgfkeysgetvalue{/pgfplots/xmin}{\xmin}
        \pgfkeysgetvalue{/pgfplots/xmax}{\xmax}
        \pgfkeysgetvalue{/pgfplots/ymin}{\ymin}
        \pgfkeysgetvalue{/pgfplots/ymax}{\ymax}

        % Calculate auxilliary quantities, in relative sense.
        \pgfmathsetmacro{\xArel}{#1}
        \pgfmathsetmacro{\yArel}{#3}
        \pgfmathsetmacro{\xBrel}{#1-#2}
        \pgfmathsetmacro{\yBrel}{\yArel}
        \pgfmathsetmacro{\xCrel}{\xArel}

        \pgfmathsetmacro{\lnxB}{\xmin*(1-(#1-#2))+\xmax*(#1-#2)} % in [xmin,xmax].
        \pgfmathsetmacro{\lnxA}{\xmin*(1-#1)+\xmax*#1} % in [xmin,xmax].
        \pgfmathsetmacro{\lnyA}{\ymin*(1-#3)+\ymax*#3} % in [ymin,ymax].
        \pgfmathsetmacro{\lnyC}{\lnyA+#4*(\lnxA-\lnxB)}
        \pgfmathsetmacro{\yCrel}{\lnyC-\ymin)/(\ymax-\ymin)} % THE IMPROVED EXPRESSION WITHOUT 'DIMENSION TOO LARGE' ERROR.

        % Define coordinates for \draw. MIND THE 'rel axis cs' as opposed to the 'axis cs'.
        \coordinate (A) at (rel axis cs:\xArel,\yArel);
        \coordinate (B) at (rel axis cs:\xBrel,\yBrel);
        \coordinate (C) at (rel axis cs:\xCrel,\yCrel);

        % Draw slope triangle.
        \draw[#5]   (A)-- node[pos=0.5,anchor=north] {1}
                    (B)-- 
                    (C)-- node[pos=0.5,anchor=west] {#4}
                    cycle;
    }
}
%%% END MACRO FOR ANNOTATION OF TRIANGLE WITH SLOPE %%%.

\newcommand{\logLogSlopeTriangleNeg}[5]
{
    % #1. Relative offset in x direction.
    % #2. Width in x direction, so xA-xB.
    % #3. Relative offset in y direction.
    % #4. Slope d(y)/d(log10(x)).
    % #5. Plot options.

    \pgfplotsextra
    {
        \pgfkeysgetvalue{/pgfplots/xmin}{\xmin}
        \pgfkeysgetvalue{/pgfplots/xmax}{\xmax}
        \pgfkeysgetvalue{/pgfplots/ymin}{\ymin}
        \pgfkeysgetvalue{/pgfplots/ymax}{\ymax}

        % Calculate auxilliary quantities, in relative sense.
        \pgfmathsetmacro{\xArel}{#1}
        \pgfmathsetmacro{\yArel}{#3}
        \pgfmathsetmacro{\xBrel}{#1-#2}
        \pgfmathsetmacro{\yBrel}{\yArel}
        \pgfmathsetmacro{\xCrel}{\xArel}

        \pgfmathsetmacro{\lnxB}{\xmin*(1-(#1-#2))+\xmax*(#1-#2)} % in [xmin,xmax].
        \pgfmathsetmacro{\lnxA}{\xmin*(1-#1)+\xmax*#1} % in [xmin,xmax].
        \pgfmathsetmacro{\lnyA}{\ymin*(1-#3)+\ymax*#3} % in [ymin,ymax].
        \pgfmathsetmacro{\lnyC}{\lnyA+#4*(\lnxA-\lnxB)}
        \pgfmathsetmacro{\yCrel}{\lnyC-\ymin)/(\ymax-\ymin)} % THE IMPROVED EXPRESSION WITHOUT 'DIMENSION TOO LARGE' ERROR.

        % Define coordinates for \draw. MIND THE 'rel axis cs' as opposed to the 'axis cs'.
        \coordinate (A) at (rel axis cs:\xArel,\yArel);
        \coordinate (B) at (rel axis cs:\xBrel,\yBrel);
        \coordinate (C) at (rel axis cs:\xCrel,\yCrel);

        % Draw slope triangle.
        \draw[#5]   (A)-- node[pos=.5,anchor=south] {1}
                    (B)-- 
                    (C)-- node[pos=0.5,anchor=west] {#4}
                    cycle;
    }
}
%%% END MACRO FOR ANNOTATION OF TRIANGLE WITH SLOPE %%%.

%%% START MACRO FOR ANNOTATION OF TRIANGLE WITH SLOPE %%%.
\newcommand{\logLogSlopeTriangleFlipNeg}[5]
{
    % #1. Relative offset in x direction.
    % #2. Width in x direction, so xA-xB.
    % #3. Relative offset in y direction.
    % #4. Slope d(y)/d(log10(x)).
    % #5. Plot options.

    \pgfplotsextra
    {
        \pgfkeysgetvalue{/pgfplots/xmin}{\xmin}
        \pgfkeysgetvalue{/pgfplots/xmax}{\xmax}
        \pgfkeysgetvalue{/pgfplots/ymin}{\ymin}
        \pgfkeysgetvalue{/pgfplots/ymax}{\ymax}

        % Calculate auxilliary quantities, in relative sense.
        %\pgfmathsetmacro{\xArel}{#1}
        %\pgfmathsetmacro{\yArel}{#3}
        \pgfmathsetmacro{\xBrel}{#1-#2}
        \pgfmathsetmacro{\yBrel}{#3}
        \pgfmathsetmacro{\xCrel}{#1}

        \pgfmathsetmacro{\lnxB}{\xmin*(1-(#1-#2))+\xmax*(#1-#2)} % in [xmin,xmax].
        \pgfmathsetmacro{\lnxA}{\xmin*(1-#1)+\xmax*#1} % in [xmin,xmax].
        \pgfmathsetmacro{\lnyA}{\ymin*(1-#3)+\ymax*#3} % in [ymin,ymax].
        \pgfmathsetmacro{\lnyC}{\lnyA+#4*(\lnxA-\lnxB)}
        \pgfmathsetmacro{\yCrel}{\lnyC-\ymin)/(\ymax-\ymin)} % THE IMPROVED EXPRESSION WITHOUT 'DIMENSION TOO LARGE' ERROR.

	\pgfmathsetmacro{\xArel}{\xBrel}
        \pgfmathsetmacro{\yArel}{\yCrel}

        % Define coordinates for \draw. MIND THE 'rel axis cs' as opposed to the 'axis cs'.
        \coordinate (A) at (rel axis cs:\xArel,\yArel);
        \coordinate (B) at (rel axis cs:\xBrel,\yBrel);
        \coordinate (C) at (rel axis cs:\xCrel,\yCrel);

        % Draw slope triangle.
        \draw[#5]   (A)-- node[pos=0.5,anchor=east] {#4}
                    (B)-- 
                    (C)-- node[pos=0.5,anchor=north] {1}
                    cycle;
    }
}
%%% END MACRO FOR ANNOTATION OF TRIANGLE WITH SLOPE %%%.


%%% START MACRO FOR ANNOTATION OF TRIANGLE WITH SLOPE %%%.
\newcommand{\logLogSlopeTriangleFlip}[5]
{
    % #1. Relative offset in x direction.
    % #2. Width in x direction, so xA-xB.
    % #3. Relative offset in y direction.
    % #4. Slope d(y)/d(log10(x)).
    % #5. Plot options.

    \pgfplotsextra
    {
        \pgfkeysgetvalue{/pgfplots/xmin}{\xmin}
        \pgfkeysgetvalue{/pgfplots/xmax}{\xmax}
        \pgfkeysgetvalue{/pgfplots/ymin}{\ymin}
        \pgfkeysgetvalue{/pgfplots/ymax}{\ymax}

        % Calculate auxilliary quantities, in relative sense.
        %\pgfmathsetmacro{\xArel}{#1}
        %\pgfmathsetmacro{\yArel}{#3}
        \pgfmathsetmacro{\xBrel}{#1-#2}
        \pgfmathsetmacro{\yBrel}{#3}
        \pgfmathsetmacro{\xCrel}{#1}

        \pgfmathsetmacro{\lnxB}{\xmin*(1-(#1-#2))+\xmax*(#1-#2)} % in [xmin,xmax].
        \pgfmathsetmacro{\lnxA}{\xmin*(1-#1)+\xmax*#1} % in [xmin,xmax].
        \pgfmathsetmacro{\lnyA}{\ymin*(1-#3)+\ymax*#3} % in [ymin,ymax].
        \pgfmathsetmacro{\lnyC}{\lnyA+#4*(\lnxA-\lnxB)}
        \pgfmathsetmacro{\yCrel}{\lnyC-\ymin)/(\ymax-\ymin)} % THE IMPROVED EXPRESSION WITHOUT 'DIMENSION TOO LARGE' ERROR.

	\pgfmathsetmacro{\xArel}{\xBrel}
        \pgfmathsetmacro{\yArel}{\yCrel}

        % Define coordinates for \draw. MIND THE 'rel axis cs' as opposed to the 'axis cs'.
        \coordinate (A) at (rel axis cs:\xArel,\yArel);
        \coordinate (B) at (rel axis cs:\xBrel,\yBrel);
        \coordinate (C) at (rel axis cs:\xCrel,\yCrel);

        % Draw slope triangle.
        \draw[#5]   (A)-- node[pos=0.5,anchor=east] {#4}
                    (B)-- 
                    (C)-- node[pos=0.5,anchor=south] {1}
                    cycle;
    }
}
%%% END MACRO FOR ANNOTATION OF TRIANGLE WITH SLOPE %%%.



\usepackage{stmaryrd}


\renewcommand{\topfraction}{0.85}
\renewcommand{\textfraction}{0.1}
\renewcommand{\floatpagefraction}{0.75}

\newcommand{\vect}[1]{\ensuremath\boldsymbol{#1}}
\newcommand{\tensor}[1]{\underline{\bm{#1}}}
\newcommand{\del}{\triangle}
\newcommand{\curl}{\grad \times}
\renewcommand{\div}{\grad \cdot}

\newcommand{\bs}[1]{\boldsymbol{#1}}
\newcommand{\equaldef}{\stackrel{\mathrm{def}}{=}}

\newcommand{\td}[2]{\frac{{\rm d}#1}{{\rm d}{\rm #2}}}
\newcommand{\pd}[2]{\frac{\partial#1}{\partial#2}}
\newcommand{\pdd}[2]{\frac{\partial^2#1}{\partial#2^2}}
\newcommand{\mb}[1]{\mathbf{#1}}
\newcommand{\mbb}[1]{\mathbb{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\snor}[1]{\left| #1 \right|}
\newcommand{\nor}[1]{\left\| #1 \right\|}
\newcommand{\LRp}[1]{\left( #1 \right)}
\newcommand{\LRs}[1]{\left[ #1 \right]}
\newcommand{\LRa}[1]{\left\langle #1 \right\rangle}
\newcommand{\LRb}[1]{\left| #1 \right|}
\newcommand{\LRc}[1]{\left\{ #1 \right\}}
\newcommand{\LRceil}[1]{\left\lceil #1 \right\rceil}
\newcommand{\LRl}[1]{\left. #1 \right|}

%\newcommand{\cond}[1]{\kappa\LRp{#1}}
\newcommand{\cond}[2]{\nor{#1}_{#2}\nor{{#1}^{-1}}_{#2}}


\newcommand{\Grad} {\ensuremath{\nabla}}
\newcommand{\Div} {\ensuremath{\nabla\cdot}}
\newcommand{\jump}[1] {\ensuremath{\llbracket#1\rrbracket}}
\newcommand{\avg}[1] {\ensuremath{\LRc{\!\{#1\}\!}}}

\newcommand{\Oh}{{\Omega_h}}
\renewcommand{\L}{L^2\LRp{\Omega}}
\newcommand{\Lk}{L^2\LRp{D^k}}
\newcommand{\Ldk}{L^2\LRp{\partial D^k}}
%\newcommand{\Lk}{D^k}
%\newcommand{\Ldk}{\partial D^k}
\newcommand{\Dhat}{\widehat{D}}
\newcommand{\Lhat}{L^2\LRp{\Dhat}}

%\newtheorem{theorem}{Theorem}[section]
%\newtheorem{lemma}[theorem]{Lemma}
%\newtheorem{proposition}[theorem]{Proposition}
%\newtheorem{corollary}[theorem]{Corollary}

%\newenvironment{definition}[1][Definition]{\begin{trivlist}
%\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
%\newenvironment{example}[1][Example]{\begin{trivlist}
%\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcommand{\eval}[2][\right]{\relax
  \ifx#1\right\relax \left.\fi#2#1\rvert}

\def\etal{{\it et al.~}}


\newcommand{\note}[1]{{\color{blue}{#1}}}
\newcommand{\remark}[1]{\textbf{\color{red}#1}}


\newcommand{\LinfDk}{L^{\infty}\LRp{D^k}}

\newcommand{\diag}[1]{{\rm diag}\LRp{#1}}

\newcommand{\Ksub}{K_{\rm sub}}

\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

%% d in integrand
\newcommand*\diff[1]{\mathop{}\!{\mathrm{d}#1}}


\makeatletter
\renewcommand\d[1]{\mspace{6mu}\mathrm{d}#1\@ifnextchar\d{\mspace{-3mu}}{}}
\makeatother

\date{}
\author{Jesse Chan, John Evans}
\title{Time-domain multi-patch discontinuous Galerkin methods}

\begin{document}

\maketitle

\begin{abstract}

Achieve extra $h$-resolution for the same CFL condition by using high order B-splines as a local approximation space on tensor product elements.  Alternatively, achieve an $O(h_N/N)$ CFL with respect to the fine-grid mesh size $h_N = h/N$.  




\end{abstract}

\tableofcontents

\section{Introduction}



Original IGA paper \cite{hughes2005isogeometric}

The ``value of continuity'' for direct solvers \cite{garcia2016value} is to decrease the number of degrees of freedom while maintaining a comparable resolution.  

DG on tets using exact geometry \cite{michoski2015foundations}

Multi-patch IGA \cite{langer2015multipatch,langer2016discontinuous}.  

%Exploiting tensor product \cite{mantzaflaris2016low}.  

Can improve work estimates \cite{chan2015bbdg}, but not CFL.  

Improving CFL: Dual-grid filter \cite{warburton2008taming}.  Adding conservation constraints \cite{xu2010conservation,xu2014new}, increasing coupling between elements.  Central DG \cite{reyna2014operator}.  

Hermite methods \cite{goodrich2006hermite,vargas2015variations}.  

The work here more closely resembles the recently introduced Galerkin difference methods \cite{banks2016galerkin}, which constructs extended-support basis functions from .  

\section{Stable timestep restrictions for time-domain DG methods}

Under the method of lines, a PDE is transformed to a system of ordinary differential equations (ODEs) 
\[
\td{\bm{U}}{t} = \bm{A}_h \bm{U}
\]
by discretizing in space.  This system may then be solved using an explicit time stepping, which avoids the inversion of a global matrix.  Since such a scheme requires only matrix-vector products, the storage of a global matrix may also be avoided through a matrix-free implementation.  Under explicit time stepping, the eigenvalues of $\bm{A}_h$ must lie within the stability region of the chosen scheme.  

Bounds on real and imaginary parts of eigenvalues can be estimated using theorems of Bendixson and Hirsch \cite{marcus1992survey}, as is done in \cite{chan2015gpu}.  

We illustrate this using the advection equation.  
\begin{align*}
V^T A_h U &= \sum_{k} \LRp{\beta\cdot\Grad u,v}_{\Lk} + \LRa{f^*(u),v}_{\Ldk} \\
&\leq \nor{\beta}_{L^\infty}\sum_{k} \nor{\Grad u}\nor{v} + \nor{f^*(u)}_{\Ldk}\nor{v}_{\Ldk}\\
&\lesssim \nor{\beta}_{L^\infty}\sum_{k} \LRp{C_I \nor{J\bm{G}}_{L^\infty\LRp{\Dhat}}  + C_N^2 \nor{J^f}_{L^\infty\LRp{\Dhat}}}\nor{1/J}_{L^\infty\LRp{\Dhat}}\nor{u}_{\Lk}\nor{v}_{\Lk}.  
\end{align*}
The CFL condition is then determined by mesh-dependent geometric factors of $O(h)$ and order-dependent constants in the inverse and trace inequalities $C_I, C_N$.  

For shape regular meshes, the ratio between volume and surface area is proportional to $h$, so 
\[
\nor{J^f}_{\LinfDk} \nor{J^{-1}}_{\LinfDk} = O(h).
\]

For polynomials, it can be shown that $C_I,C_N$ both depend quadratically on the degree $N$ (see, for example \cite{warburton2003constants, ozisik2010constants}).  Thus, for DG methods based on locally polynomial approximation spaces, the spectral radius can be bounded by the mesh size, polynomial order, and maximum wavespeed
\[
\rho\LRp{\bm{A}_h} = O\LRp{\frac{\beta_{\max} N^2}{h}}.  
\]
The quadratic dependence of $\rho\LRp{\bm{A}_h}$ on $N$ results in small timesteps if $N$ is large, making the use of high polynomial degrees computationally intractable.  

\subsection{Explicit constants in trace and inverse inequalities for polynomial and B-spline approximations}




For polynomials, $C_I, C_N = O(N^2)$ on the reference element .  

For B-splines with $K_{\rm sub} = N$, $C_N = O(N)$ instead of $O(N^2)$.  

For sufficiently regular solutions, convergence is in $L^2$ as $C (h/N)^{N+1}$ while still maintaining an $O(h/N^2)$ CFL.  Or, if we measure by $h_N = h/N$, CFL is $O(h_N/N)$.  This results from interpolation estimates for one-dimensional B-splines \cite{bazilevs2006isogeometric}.  

Show plots of lift functions for polynomials vs for B-spline bases - less oscillation for B-splines.  

\begin{figure}
\centering
\subfloat[$N_P = N+\Ksub$]{\includegraphics[width=.4\textwidth]{figs/lift1.png}}
\subfloat[Zoom in]{\includegraphics[width=.4\textwidth]{figs/liftZoom1.png}}\\
\subfloat[$N_P = N$]{\includegraphics[width=.4\textwidth]{figs/lift2.png}}
\subfloat[Zoom in]{\includegraphics[width=.4\textwidth]{figs/liftZoom2.png}}
\caption{Comparison of lift functions for a degree $N_P$ polynomial space and spline space with degree $N = 7$ and $\Ksub = N$ elements.  Degree $N_P$ Gauss-Radau quadrature points are also shown for comparison.  }
\end{figure}

\section{DG formulation}

Skew-symmetric form is energy stable for acoustic, electromagnetic, and elastic wave propagation.  Disadvantage of IGA-DG vs SEM is a lack of equivalence with strong and weak formulations \cite{kopriva2010quadrature}

Penalty fluxes \cite{chan2016short} for dissipation.  

Avoid mass matrix inversion using weight-adjusted DG \cite{chan2016weight1,chan2016weight2}.  Especially important for IGA-DG since it decouples the inversion of the mass matrix into a Kronecker structure.  

\section{Quadrature }

Reduce dimension of the search space by treating the weights as dependent variables and assuming symmetry of the rule.  Initialize guess for quadrature rule using the previous order's rule to generate a polynomial interpolant from equispaced nodes to quadrature nodes \cite{warburton2006explicit,chan2015comparison}.  

We note that these rules are generated by choosing the number of points $N_q$ such that ${\rm dim}(S_{\rm target}) \leq 2N_q$, and may not be optimal.  The problem is that, to exactly integrate the target space, $N_q = O(N^2)$.  Reduced quadratures are thus necessary.  

\subsection{Reduced quadrature rules}

The derivative of a spline does not map into the same spline space; instead, it decreases both the order and continuity.  The derivative operator then satisfies $\pd{}{x} : S^N_{N-1}\rightarrow S^{N-1}_{N-2}$.  To define a derivative operator which maps from $S^N_{N-1}$ to itself, we use an $L^2$ projection.  
\[
\int_{D^k} a(x)\pd{u}{x} v = \int_{\widehat{D}} a(x)\pd{r}{x}J\pd{u}{r} v = \int_{\widehat{D}} a(x)\LRp{\pd{r}{x}J} \Pi_N\LRp{\pd{u}{r}} v.  
\]

Can cast into collocation style using skew-symmetric formulation by using a degree $N + K_{\rm sub} - 1$ Gauss-Legendre or Gauss-Lobatto rule.  

Problems here - high order accuracy is preserved if the mass matrix is under-integrated, but not if an isoparametric mapping is used.  


\section{Future work}

GLL-based spectral elements have other advantages, notably a connection to summation by parts (SBP) operators.  Wave propagation problems yield variational formulations which are a-priori stable under inexact quadrature.  However, SBP properties are crucial to guaranteeing energy stability for more complex physics, such as nonlinear hyperbolic conservation laws.  

\bibliographystyle{unsrt}
\bibliography{dgpenalty}


\end{document}


