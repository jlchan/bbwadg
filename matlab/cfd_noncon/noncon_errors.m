%% T = 5 affine (old)

errGQ{1}   = [2.0534 0.7966 0.2022 0.044941319537939];
errGQ{2}   = [0.7191 0.1410 0.0178 0.002430874467105];
errGQ{3}   = [0.352705742384143 0.025841463466792 0.002119526920617 1.329691481517913e-04];
errGQ{4}   = [0.128216544764112  0.007799434615354 2.708033443689105e-04];

% N = 2, K = 6, 12, 24
% N=2, K = 6 => CFL = .125
errGLL{1} = [2.6993 1.6718 0.7792 0.292109958892711];
errGLL{2} = [1.1609 0.3562 0.0768 0.019219699366989];
errGLL{3} = [0.551144794755657 0.075423746794403 0.010080750935226 0.001206331314505];
errGLL{4} = [0.267668437449872 0.019260296092443 0.001403412727647];

errGLL_GQ{1} = [2.940784290640242 1.730573958007535 0.970690441574172 0.487386502922445];
errGLL_GQ{2} = [1.202913631932297 0.347365488887244 0.060668794291770 0.014484331163411];
errGLL_GQ{3} = [0.557083582743921 0.067137254466507 0.007440855236839 8.379051403197340e-04];
errGLL_GQ{4} = [0.212176177769505 0.015117765948094 8.263069256789442e-04];

%% T = 5 affine

errGQ{1} = [2.307719415783393, 1.166969584635542, 0.303428203233120 0.057680744153621];
errGQ{2} = [1.061690643897536, 0.158533673322821, 0.020873713337098 0.002749744860019];
errGQ{3} = [0.455651126029566, 0.032880536886007, 0.002336082881396 1.431118255761381e-04];
errGQ{4} = [0.173236920250840, 0.008582605194047, 2.950098208718262e-04];

errGLL_GQ{1} = [2.815659940227669   2.212197571204939   1.446262299209713  0.801638469096200];
errGLL_GQ{2} = [1.526434542287588   0.436465830091857   0.080157545148039 0.016704324198057];
errGLL_GQ{3} = [0.685654887493273   0.081590642470880   0.008382706372800 8.891468211548662e-04];
errGLL_GQ{4} = [0.241312258875697   0.016996513779885   0.000928105579820];

errGLL{1} = [2.783173392697054, 2.098938326779315, 1.254781147026747, 0.490133373721046];
errGLL{2} = [1.517663055895442, 0.431437481592981, 0.079201712015503, 0.016725338557031];
errGLL{3} = [0.687969717851423, 0.082189414713530, 0.008229003732176, 8.561284078463736e-04];
errGLL{4} = [0.242583656997455, 0.017023775419009, 9.226184666078243e-04];

h = (10/6)*.5.^(0:3);
for N = 1:4
    print_pgf_coordinates(h(1:length(errGQ{N})),errGLL{N})
    print_pgf_coordinates(h(1:length(errGQ{N})),errGLL_GQ{N})
    print_pgf_coordinates(h(1:length(errGQ{N})),errGQ{N})
    fprintf('\n')
end
 
%% T = 5, Linf affine

% L2err_GQ{1} = [0.711489345230616, 0.319683006305272, 0.106910902625192, 0.032814317881228];
% L2err_GQ{2} = [0.323915382521897, 0.070023512680668, 0.021775639468255, 0.002508523056850];
%     [0.250176600110577, 0.036798877539780, 0.002553581419313]                    
% 
% a = 0
% 
% L2err_GLL =  [0.826716220471304, 0.588409725897732, 0.372899407664201, 0.179170539144878]
%     [0.413008504315206, 0.134122895573613, 0.042036100233369, 0.009375333878079]
%     [0.240076711703644, 0.075322358921057, 0.011529041505423]                     []


%% T = 5 curved

errGLL_GQ{1} = [2.828704322974143 2.360620489310406 1.618414271529383 0.909621202013947];
errGLL_GQ{2} = [1.888572180410994 0.709213500803328 0.135322919652696 0.019662066509109];
errGLL_GQ{3} = [1.035571430522574 0.211254780461944 0.019621429311511 0.001874395956011];
errGLL_GQ{4} = [0.557251082442663 0.059376687563437 0.002841634745686];

errGLL{1} = [2.840183824540210, 2.322781193784854, 1.448775530843086, 0.608641924768199];
errGLL{2} = [1.889970762568306, 0.710146136051938, 0.136728125628338, 0.019641147453783];
errGLL{3} = [1.030214848436976, 0.211902164894138, 0.019501765967692, 0.001849235430023];
errGLL{4} = [0.558299255928951, 0.059482831455834, 0.002846969403098];

errGQ{1} = [2.429379132809644 1.403806422281637 0.504183950815740 0.114213052116372];
errGQ{2} = [1.321181161144220 0.310972665180244 0.036979411251686 0.004574922487553];
errGQ{3} = [0.687500057895588 0.083725784009249 0.005207196358582 2.983181817434459e-04];
errGQ{4} = [0.330743078722776 0.020408417717138 6.918754150848914e-04];

h = (10/6)*.5.^(0:3);
for N = 1:4
    print_pgf_coordinates(h(1:length(errGQ{N})),errGLL{N})
    print_pgf_coordinates(h(1:length(errGQ{N})),errGLL_GQ{N})
    print_pgf_coordinates(h(1:length(errGQ{N})),errGQ{N})
    fprintf('\n')
end

%%

for N = 1:3
    h = .5.^(1:length(errGLL{N}));

    n = 1; % # terms for lsq fit
    loglog(h,errGLL{N},'o--')
    hold on   
    C = [ones(n+1,1) log(h(end-n:end)')]\log(errGLL{N}(end-n:end)');    
    rGLL{N} = C(2); % N+1/2;
    scale = errGLL{N}(end)/h(end)^rGLL{N};
    loglog(h,scale*h.^rGLL{N},'k-')
    text(h(end),scale*h(end).^rGLL{N},num2str(rGLL{N}))
    
    loglog(h,errGQ{N},'x--')
    C = [ones(n+1,1) log(h(end-n:end)')]\log(errGQ{N}(end-n:end)');    
    rGQ{N} = C(2);
    scale = errGQ{N}(end)/h(end)^rGQ{N};
    loglog(h,scale*h.^rGQ{N},'k-')
    text(h(end),scale*h(end).^rGQ{N},num2str(rGQ{N}))
end