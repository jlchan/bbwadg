function [H,Q,X]=CSBPp3(n)
%n = number of nodes in the nodal distribution

Q = zeros(n,n);
H = eye(n,n);
X = zeros(n,1); 

%construct the nodal distribution
dx = 2/(n-1);

for i = 1:n
  X(i) = -1+(i-1)*dx; 
end

Hdiag = [0.13649e5 / 0.43200e5 0.12013e5 / 0.8640e4 0.2711e4 / 0.4320e4 0.5359e4 / 0.4320e4 0.7877e4 / 0.8640e4 0.43801e5 / 0.43200e5];

% construct the H matrix_type
for i = 1:6
H(i,i)=Hdiag(i);
H(n-i+1,n-i+1) = Hdiag(i);
end

% add the mesh spacing
H = dx*H;

% construct the upper portion of Q
Q(1:6,1:9) =   [-0.500000000000000000000000000000e0 0.646081241864629364709953315160e0 -0.592593810387643724200601742186e-1 -0.120480141404816404332872701635e0 0.184643843933343930120385912135e-1 0.151938961856170190309409694806e-1 0 0 0; -0.646081241864629364709953315160e0 0 0.435773838399380066852619571349e0 0.287113588633338631726859622734e0 -0.415360016601891589803299022358e-1 -0.352701835079001748891959766877e-1 0 0 0; 0.592593810387643724200601742186e-1 -0.435773838399380066852619571349e0 0 0.453183479267895936174374945167e0 -0.871148064283897633348687723275e-1 0.104457845211095215930532242909e-1 0 0 0; 0.120480141404816404332872701635e0 -0.287113588633338631726859622734e0 -0.453183479267895936174374945167e0 0 0.681761492720367721173607225670e0 -0.786112328906162242719120260704e-1 0.166666666666666666666666666667e-1 0 0; -0.184643843933343930120385912135e-1 0.415360016601891589803299022358e-1 0.871148064283897633348687723275e-1 -0.681761492720367721173607225670e0 0 0.704908402358456525203780475653e0 -0.150000000000000000000000000000e0 0.166666666666666666666666666667e-1 0; -0.151938961856170190309409694806e-1 0.352701835079001748891959766877e-1 -0.104457845211095215930532242909e-1 0.786112328906162242719120260704e-1 -0.704908402358456525203780475653e0 0 0.750000000000000000000000000000e0 -0.150000000000000000000000000000e0 0.166666666666666666666666666667e-1;];


% construct the lower portion of Q
for i = 1:6
  for j = 1:9
    Q(n-i+1,n-j+1) = -Q(i,j);
  end
end

% construct the interior of Q
for i=7:n-6
  Q(i,i-3:i+3) = [-0.1e1 / 0.60e2 0.3e1 / 0.20e2 -0.3e1 / 0.4e1 0 0.3e1 / 0.4e1 -0.3e1 / 0.20e2 0.1e1 / 0.60e2;];
end